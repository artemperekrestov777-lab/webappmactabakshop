<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∞–∫–¢–∞–±–∞–∫ - –õ—É—á—à–∏–π —Ç–∞–±–∞—á–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="welcomeScreen" class="welcome-screen">
        <div class="welcome-content">
            <h1 class="welcome-title">–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨!</h1>
            <div class="logo-container">
                <img src="https://raw.githubusercontent.com/artemperekrestov777-lab/webappmactabakshop/main/MakTabak_logo_new.png"
                     alt="–ú–∞–∫–¢–∞–±–∞–∫" class="logo"
                     onerror="this.style.display='none'; document.querySelector('.logo-fallback').style.display='flex'">
                <div class="logo-fallback" style="display: none;">
                    <div class="logo-circle">
                        <div class="logo-text">–ú–ê–ö<br>–¢–ê–ë–ê–ö</div>
                    </div>
                </div>
            </div>
            <h2 class="welcome-subtitle">–õ—É—á—à–∏–π –¢–∞–±–∞—á–Ω—ã–π –ú–∞–≥–∞–∑–∏–Ω</h2>
            <button class="catalog-btn" onclick="showCatalog()">üõí –ö–∞—Ç–∞–ª–æ–≥</button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div id="mainContainer" style="display: none;">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="header">
            <button class="back-btn" id="backBtn" onclick="goBack()">‚Üê</button>
            <h1 class="header-title">–ú–ê–ö–¢–ê–ë–ê–ö</h1>
            <button class="search-btn" onclick="toggleSearch()">üîç</button>
        </header>

        <!-- –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ -->
        <div id="searchBar" class="search-bar" style="display: none;">
            <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." oninput="searchProducts()">
            <button onclick="clearSearch()">‚úñ</button>
        </div>

        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
        <div class="controls">
            <button class="sort-btn" onclick="showSortMenu()">‚ÜïÔ∏è</button>
            <div class="categories-scroll">
                <div class="categories" id="categoriesContainer"></div>
            </div>
        </div>

        <!-- –ú–µ–Ω—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
        <div id="sortMenu" class="sort-menu" style="display: none;">
            <button onclick="sortProducts('default')">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
            <button onclick="sortProducts('price_asc')">–¶–µ–Ω–∞ ‚Üë</button>
            <button onclick="sortProducts('price_desc')">–¶–µ–Ω–∞ ‚Üì</button>
            <button onclick="sortProducts('new')">–ù–æ–≤–∏–Ω–∫–∏</button>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div class="products-container" id="productsContainer"></div>

        <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
        <div id="cartScreen" class="cart-screen" style="display: none;">
            <div class="cart-header">
                <button onclick="closeCart()">‚Üê</button>
                <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
                <button onclick="clearCart()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
            <div id="cartItems" class="cart-items"></div>
            <div id="emptyCart" class="empty-cart" style="display: none;">
                <div class="pipe-icon">üö¨</div>
                <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                <button onclick="closeCart()">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–æ–∫—É–ø–∫–∞–º</button>
            </div>
            <div id="cartSummary" class="cart-summary">
                <div class="summary-row">
                    <span>–ò—Ç–æ–≥–æ:</span>
                    <span id="cartTotal">0‚ÇΩ</span>
                </div>
                <button class="checkout-btn" onclick="showCheckout()">
                    –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ <span id="checkoutTotal">0‚ÇΩ</span>
                </button>
            </div>
        </div>

        <!-- –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ -->
        <div id="checkoutScreen" class="checkout-screen" style="display: none;">
            <div class="checkout-header">
                <button onclick="closeCheckout()">‚Üê</button>
                <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
            </div>
            <form id="checkoutForm" class="checkout-form">
                <div class="form-group">
                    <label>–§–ò–û –ø–æ–ª–Ω–æ—Å—Ç—å—é *</label>
                    <input type="text" id="fullName" required pattern="[–ê-–Ø–∞-—è–Å—ë\s]{10,}"
                           placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ *</label>
                    <input type="tel" id="phone" required pattern="[+]?[0-9]{11,}"
                           placeholder="+7 900 123 45 67">
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="email" required
                           placeholder="example@mail.ru">
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>–ì–æ—Ä–æ–¥ *</label>
                    <input type="text" id="city" required
                           placeholder="–ú–æ—Å–∫–≤–∞">
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>–†–µ–≥–∏–æ–Ω/–û–±–ª–∞—Å—Ç—å *</label>
                    <input type="text" id="region" required
                           placeholder="–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å">
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                    <textarea id="address" required
                              placeholder="—É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1, –∫–≤. 10"></textarea>
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                    <select id="deliveryMethod" required onchange="updateDeliveryPrice()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±</option>
                        <option value="pochta">–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏ - 500‚ÇΩ</option>
                        <option value="sdek">–°–î–≠–ö - 600‚ÇΩ</option>
                    </select>
                    <span class="error-message"></span>
                </div>

                <div class="form-group">
                    <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
                    <textarea id="comment" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"></textarea>
                </div>

                <div class="checkout-summary">
                    <div class="summary-row">
                        <span>–¢–æ–≤–∞—Ä—ã:</span>
                        <span id="checkoutSubtotal">0‚ÇΩ</span>
                    </div>
                    <div class="summary-row">
                        <span>–î–æ—Å—Ç–∞–≤–∫–∞:</span>
                        <span id="checkoutDelivery">0‚ÇΩ</span>
                    </div>
                    <div class="summary-row total">
                        <span>–ò—Ç–æ–≥–æ:</span>
                        <span id="checkoutFinalTotal">0‚ÇΩ</span>
                    </div>
                </div>

                <button type="submit" class="submit-order-btn">
                    –û–ø–ª–∞—Ç–∏—Ç—å <span id="submitTotal">0‚ÇΩ</span>
                </button>
            </form>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–æ–≤–∞—Ä–∞ -->
        <div id="productModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeProductModal()">&times;</span>
                <img id="modalImage" src="" alt="">
                <h3 id="modalTitle"></h3>
                <p id="modalDescription"></p>
                <div class="modal-price" id="modalPrice"></div>
                <div class="modal-buttons">
                    <button class="add-to-cart-btn" onclick="addToCartFromModal()">
                        –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
        <button id="cartBtn" class="cart-btn" onclick="showCart()">
            üõí
            <span id="cartCount" class="cart-count">0</span>
        </button>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader" style="display: none;">
        <div class="spinner"></div>
    </div>

    <script src="products.js"></script>
    <script src="app.js"></script>
</body>
</html>